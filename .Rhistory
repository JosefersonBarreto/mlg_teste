library(hcp)
library(hpc)
hnp(mod$residuals, sim = 99,resid.type ='deviance',how.many.out=T ,conf = 0.95,scale = T)
library(hnp)
hnp(mod$residuals, sim = 99,resid.type ='deviance',how.many.out=T ,conf = 0.95,scale = T)
library(randomForest)
importancia  = randomForest(price ~ ., data = novo)
col = importance(importancia)
options(scipen=999)
par(bg = '#586573')
varImpPlot(importancia)
#install.packages('DescTools')
library(DescTools)
PseudoR2(mod)
PseudoR2(mod3)
PseudoR2(mod.nb)
mod.nb <- glm.nb(price~., data = novo)
summary(mod.nb)
hnp(mod.nb$residuals, sim = 99,resid.type ='deviance',how.many.out=T ,
conf = 0.95,scale = T)
# nv<- novo[11:16]
#
mod<-glm(price~.,family = Gamma(link=log),data = novo)
table(dados$engine.type)
summary(mod)
library(hnp)
hnp(mod$residuals, sim = 99,resid.type ='deviance',how.many.out=T ,conf = 0.95,scale = T)
summary(mod)
library(randomForest)
importancia  = randomForest(price ~ ., data = novo)
col = importance(importancia)
options(scipen=999)
par(bg = '#586573')
varImpPlot(importancia)
# nv<- novo[11:16]
#
mod<-glm(price~.,family = Gamma(link=log),data = novo,na.action = T)
# nv<- novo[11:16]
#
mod<-glm(price~.,family = Gamma(link=log),data = novo,na.action = F)
# nv<- novo[11:16]
#
mod<-glm(price~.,family = Gamma(link=log),data = novo,na.omit())
# nv<- novo[11:16]
#
mod<-glm(price~.,family = Gamma(link=log),na.action = T,data = novo)
glm(price~make+horsepower+num.of.cylinders+drive.wheels+fuel.system+
compression.ratio+engine.type+body.style+peak.rpm, data = novo)
mod2<-glm(price~make+horsepower+num.of.cylinders+drive.wheels+fuel.system+
compression.ratio+engine.type+body.style+peak.rpm, data = novo)
summary(mod2)
hnp(mod2$residuals, sim = 99,resid.type ='deviance',how.many.out=T ,conf = 0.95,scale = T)
hnp(mod2$residuals, sim = 99,resid.type ='deviance',how.many.out=T ,conf = 0.95,scale = T)
mod2<-glm(price~make+horsepower+num.of.cylinders+fuel.system+
compression.ratio+engine.type+body.style+peak.rpm, data = novo)
summary(mod2)
hnp(mod2$residuals, sim = 99,resid.type ='deviance',how.many.out=T ,conf = 0.95,scale = T)
mod2<-glm(price~make+horsepower+num.of.cylinders+fuel.system+
compression.ratio+body.style+peak.rpm, data = novo)
summary(mod2)
hnp(mod2$residuals, sim = 99,resid.type ='deviance',how.many.out=T ,conf = 0.95,scale = T)
mod2<-glm(price~make+horsepower+num.of.cylinders+fuel.system+
compression.ratio+body.style+engine.type, data = novo)
hnp(mod2$residuals, sim = 99,resid.type ='deviance',how.many.out=T ,conf = 0.95,scale = T)
mod2<-glm(price~make+horsepower+num.of.cylinders+drive.wheels+fuel.system+
compression.ratio+engine.type+body.style+peak.rpm,family = Gamma(link=log), data = novo)
summary(mod2)
hnp(mod2$residuals, sim = 99,resid.type ='deviance',how.many.out=T ,conf = 0.95,scale = T)
mod2<-glm(price~make+horsepower+num.of.cylinders+drive.wheels+fuel.system+
compression.ratio+engine.type+body.style+peak.rpm,family = poisson(link=log), data = novo)
summary(mod2)
hnp(mod2$residuals, sim = 99,resid.type ='deviance',how.many.out=T ,conf = 0.95,scale = T)
PseudoR2(mod2)
#mod2<-glm(price~ compression.ratio+horsepower+peak.rpm,family = Gamma(link=log),data = novo)
# modelo com as variaveis selecionadas
mod2<-glm(price~normalized.losses+compression.ratio+horsepower+peak.rpm
,family = Gamma(link=log),data = novo)
summary(mod2)
mod2<-glm(price~make+horsepower+num.of.cylinders+drive.wheels+fuel.system+
compression.ratio+engine.type+body.style+peak.rpm,family = poisson(link=log), data = novo)
summary(mod2)
hnp(mod2$residuals, sim = 99,resid.type ='deviance',how.many.out=T ,conf = 0.95,scale = T)
PseudoR2(mod2)
# nv<- novo[11:16]
#
mod<-glm(price~.,family = Gamma(link=log),data = novo)
PseudoR2(mod)
mod3<-glm(price~make+horsepower+num.of.cylinders+drive.wheels+fuel.system+
compression.ratio+engine.type+body.style+peak.rpm,family = gamma(link="inverse"), data = novo)
mod3<-glm(price~make+horsepower+num.of.cylinders+drive.wheels+fuel.system+
compression.ratio+engine.type+body.style+peak.rpm,family = Gamma(link = "inverse"), data = novo)
summary(mod2)
summary(mod3)
mod3<-glm(price~make+horsepower+num.of.cylinders+drive.wheels+fuel.system+
compression.ratio+engine.type+body.style+peak.rpm,family = gaussian(link = "identity"), data = novo)
summary(mod)
PseudoR2(mod3)
hnp(mod3$residuals, sim = 99,resid.type ='deviance',how.many.out=T ,conf = 0.95,scale = T)
mod3<-glm(price~make+horsepower+num.of.cylinders+drive.wheels+fuel.system+
compression.ratio+engine.type+body.style+peak.rpm,family = inverse.gaussian(link = "1/mu^2"), data = novo)
summary(mod)
fam
library(DescTools)
PseudoR2(mod2)
PseudoR2(mod3)
hnp(mod3$residuals, sim = 99,resid.type ='deviance',how.many.out=T ,conf = 0.95,scale = T)
mod3<-glm(price~make+horsepower+num.of.cylinders+drive.wheels+fuel.system+
compression.ratio+engine.type+body.style+peak.rpm,family = gaussian(link = "inverse"), data = novo)
summary(mod)
fam
library(DescTools)
PseudoR2(mod2)
PseudoR2(mod3)
hnp(mod3$residuals, sim = 99,resid.type ='deviance',how.many.out=T ,conf = 0.95,scale = T)
mod3<-glm(price~make+horsepower+num.of.cylinders+drive.wheels+fuel.system+
compression.ratio+engine.type+body.style+peak.rpm,family = gaussian(link = "logit"), data = novo)
mod3<-glm(price~make+horsepower+num.of.cylinders+drive.wheels+fuel.system+
compression.ratio+engine.type+body.style+peak.rpm,family = gaussian(link = "inverse"), data = novo)
summary(mod)
fam
library(DescTools)
PseudoR2(mod2)
PseudoR2(mod3)
mod3<-glm(price~make+horsepower+num.of.cylinders+drive.wheels+fuel.system+
compression.ratio+engine.type+body.style+peak.rpm,family = gamma(link = "inverse"), data = novo)
mod3<-glm(price~make+horsepower+num.of.cylinders+drive.wheels+fuel.system+
compression.ratio+engine.type+body.style+peak.rpm,family = poisson(link = "log"), data = novo)
summary(mod)
fam
library(DescTools)
PseudoR2(mod2)
PseudoR2(mod3)
hnp(mod3$residuals, sim = 99,resid.type ='deviance',how.many.out=T ,conf = 0.95,scale = T)
mod3<-glm(price~make+horsepower+num.of.cylinders+drive.wheels+fuel.system+
compression.ratio+engine.type+body.style+peak.rpm,family = poisson(link = "logit"), data = novo)
mod3<-glm(price~make+horsepower+num.of.cylinders+drive.wheels+fuel.system+
compression.ratio+engine.type+body.style+peak.rpm,family = poisson(link = "identity"), data = novo)
summary(mod)
fam
library(DescTools)
mod3<-glm(price~make+horsepower+num.of.cylinders+drive.wheels+fuel.system+
compression.ratio+engine.type+body.style+peak.rpm,family = poisson(link = "identity"), data = novo)
PseudoR2(mod2)
PseudoR2(mod3)
hnp(mod3$residuals, sim = 99,resid.type ='deviance',how.many.out=T ,conf = 0.95,scale = T)
require(MASS)
mod.nb <- glm.nb(price~., data = novo)
summary(mod.nb)
boxplot(novo$price)
boxplot(log(novo$price+1))
mod2<-glm(log(novo$price+1)~make+horsepower+num.of.cylinders+drive.wheels+fuel.system+
compression.ratio+engine.type+body.style+peak.rpm,family = poisson(link=log), data = novo)
PseudoR2(mod2)
boxplot(log(novo$price))
log(novo$price)
hist(log(novo$price))
# trabalhando com o preço transformado
novo2<-novo
round(log(novo2$price+1),2)
round(log(novo2$price+1),1)
round(log(novo2$price+1),0)
hist(round(log(novo2$price+1),0))
hist(round(log(novo2$price+1),1))
hist(round(log(novo2$price+1),3))
log(novo2$price+1)
novo2$price<-log(novo2$price+1)
mod2<-glm(price~make+horsepower+num.of.cylinders+drive.wheels+fuel.system+
compression.ratio+engine.type+body.style+peak.rpm,family = poisson(link=log), data = novo)
hnp(mod2$residuals, sim = 99,resid.type ='deviance',how.many.out=T ,conf = 0.95,scale = T)
mod3<-glm(price~make+horsepower+num.of.cylinders+drive.wheels+fuel.system+
compression.ratio+engine.type+body.style+peak.rpm,family = poisson(link = "identity"), data = novo)
PseudoR2(mod2)
mod2<-glm(price~make+horsepower+num.of.cylinders+drive.wheels+fuel.system+
compression.ratio+engine.type+body.style+peak.rpm,family = poisson(link=log), data = novo2)
hnp(mod2$residuals, sim = 99,resid.type ='deviance',how.many.out=T ,conf = 0.95,scale = T)
PseudoR2(mod2)
mod2<-glm(price~make+horsepower+num.of.cylinders+drive.wheels+fuel.system+
compression.ratio+engine.type+body.style+peak.rpm,family = gamma(link=log), data = novo2)
mod2<-glm(price~make+horsepower+num.of.cylinders+drive.wheels+fuel.system+
compression.ratio+engine.type+body.style+peak.rpm,family = gamma(link='log'), data = novo2)
mod2<-glm(price~make+horsepower+num.of.cylinders+drive.wheels+fuel.system+
compression.ratio+engine.type+body.style+peak.rpm,family = Gamma(link = "inverse"), data = novo2)
PseudoR2(mod2)
hnp(mod2$residuals, sim = 99,resid.type ='deviance',how.many.out=T ,conf = 0.95,scale = T)
mod2<-glm(price~make+horsepower+num.of.cylinders+drive.wheels+fuel.system+
compression.ratio+engine.type+body.style+peak.rpm,family = Gamma(link = "logit"), data = novo2)
mod.nb <- glm.nb(price~make+horsepower+num.of.cylinders+drive.wheels+fuel.system+
compression.ratio+engine.type+body.style+peak.rpm, data = novo2)
summary(mod.nb)
sqrt(novo$price)
hist(sqrt(novo$price))
boxplot(sqrt(novo$price))
novo2$price<-log(novo$price)
mod2<-glm(price~make+horsepower+num.of.cylinders+drive.wheels+fuel.system+
compression.ratio+engine.type+body.style+peak.rpm,family = Gamma(link = "logit"), data = novo2)
mod2<-glm(price~make+horsepower+num.of.cylinders+drive.wheels+fuel.system+
compression.ratio+engine.type+body.style+peak.rpm,family = Gamma(link = "log"), data = novo2)
hnp(mod2$residuals, sim = 99,resid.type ='deviance',how.many.out=T ,conf = 0.95,scale = T)
mod2<-glm(price~make+horsepower+num.of.cylinders+drive.wheels+fuel.system+
compression.ratio+engine.type+body.style+peak.rpm,family = poisson(link = "log"), data = novo2)
mod.nb <- glm.nb(price~make+horsepower+num.of.cylinders+drive.wheels+fuel.system+
compression.ratio+engine.type+body.style+peak.rpm, data = novo2)
summary(mod.nb)
boxplot(scale(novo$price))
mod2<-glm(price~make+horsepower+num.of.cylinders+drive.wheels+fuel.system+
compression.ratio+engine.type+body.style+peak.rpm,family = poisson(link=log), data = novo)
mod.nb <- glm.nb(price~make+horsepower+num.of.cylinders+drive.wheels+fuel.system+
compression.ratio+engine.type+body.style+peak.rpm, data = )
mod.nb <- glm.nb(price~make+horsepower+num.of.cylinders+drive.wheels+fuel.system+
compression.ratio+engine.type+body.style+peak.rpm, data = novo)
summary(mod.nb)
mod2<-glm(price~make+horsepower+num.of.cylinders+drive.wheels+fuel.system+
compression.ratio+engine.type+body.style+peak.rpm,family = poisson(link=log), data = novo)
PseudoR2(mod2)
mod3<-glm(price~make+horsepower+num.of.cylinders+drive.wheels+fuel.system+
compression.ratio+engine.type+body.style+peak.rpm,family = poisson(link = "identity"), data = novo)
PseudoR2(mod3)
hnp(mod2$residuals, sim = 99,resid.type ='deviance',how.many.out=T ,conf = 0.95,scale = T)
hnp(mod3$residuals, sim = 99,resid.type ='deviance',how.many.out=T ,conf = 0.95,scale = T)
hnp(mod2, sim = 99,resid.type ='deviance',how.many.out=T ,conf = 0.95,scale = T)
mod2<-glm(price~make+horsepower+num.of.cylinders+drive.wheels+fuel.system+
compression.ratio+engine.type+body.style+peak.rpm,family = Gamma(link=log), data = novo)
PseudoR2(mod2)
mod2<-glm(price~make+horsepower+num.of.cylinders+drive.wheels+fuel.system+
compression.ratio+engine.type+body.style+peak.rpm,family = poisson(link=log), data = novo)
mod2<-glm(price~make+horsepower+num.of.cylinders+fuel.system+
compression.ratio+body.style+engine.type,poisson(link = "identity"), data = novo)
hnp(mod2, sim = 99,resid.type ='deviance',how.many.out=T ,conf = 0.95,scale = T)
mod2<-glm(price~make+horsepower+num.of.cylinders+fuel.system+
compression.ratio+body.style+engine.type,poisson(link = "log"), data = novo)
hnp(mod2, sim = 99,resid.type ='deviance',how.many.out=T ,conf = 0.95,scale = T)
t %>%
cor() %>%
findCorrelation( cutoff = .50, verbose = FALSE)
library(readr)
dados <- read_csv("carrosTrat.csv",
col_types = cols(stroke = col_double()))
dados$price<-as.numeric(dados$price)
head (dados)
round(mean(is.na(dados))*100,10)
View(dados)
library(readr)
dados<-read.table("dados.txt",sep = ",",header = TRUE)
dados$price<-as.numeric(dados$price)
head (dados)
View(dados)
round(mean(is.na(dados))*100,10)
library(skimr)
skim(dados)
dados[is.na(dados$stroke),]$stroke = median(dados$stroke,na.rm = T)
dados$stroke<-as.numeric(dados$stroke)
dados[is.na(dados$stroke),]$stroke = median(dados$stroke,na.rm = T)
dados$stroke<-as.numeric(dados$stroke)
dados[is.na(dados$stroke),]$stroke = median(dados$stroke,na.rm = T)
library(ggplot2)
dados %>% ggplot(aes(price))+
geom_density(fill = "darkblue")+
labs(x= "Preço", y="Densidade")
shapiro.test(dados$price)
is.na(dados)
!is.na(dados)
round(mean(!is.na(dados))*100,10)
round(mean(is.na(dados))*100,10)
library(tidyverse)
library(tidyverse)
library(DT)
library(readxl)
dados<-read.table("dados.txt",sep = ",",header = TRUE)
sum(dados[!complete.cases(dados),])
glimpse(dados)
dados[3:9]<-dados[3:9] %>% mutate_if(is.character,as.factor)
dados[15:16]<-dados[15:16] %>% mutate_if(is.character,as.factor)
dados[18]<-dados[18] %>% mutate_if(is.character,as.factor)
dados[20]<-dados[20] %>% mutate_if(is.character,as.factor)
dados<-dados %>% mutate_if(is.character,as.numeric)
library(gt)
dados |> head(10) |> gt()
dados |> head(10) |> gt()
dados[is.na(dados$normalized.losses),]$normalized.losses =median(dados$normalized.losses,na.rm = T)
dados[is.na(dados$price),]$price = median(dados$price,na.rm = T)
dados$stroke<-as.numeric(dados$stroke)
dados[is.na(dados$stroke),]$stroke = median(dados$stroke,na.rm = T)
dados$stroke<-as.numeric(dados$stroke)
dados[is.na(dados$stroke),]$stroke = median(dados$stroke,na.rm = T)
dados$stroke
dados<-read.table("dados.txt",sep = ",",header = TRUE)
View(dados)
library(tidyverse)
library(DT)
library(readxl)
dados |> filter( stroke == "?"
)
t<-dados |> filter( stroke == "?"
)
View(t)
View(dados)
dados$stroke[dados$stroke == "?"] <- "NA"
View(dados)
dados$bore[dados$bore == "?"] <- "NA"
View(dados)
dados$normalized.losses[dados$normalized.losses == "?"] <- "NA"
View(dados)
dados$num.of.doors[dados$num.of.doors == "?"] <- "NA"
View(dados)
dados$engine.size[dados$engine.size == "?"] <- "NA"
View(dados)
dados$engine.size[dados$engine.size == "l"] <- "NA"
dados$engine.size[dados$engine.size == "|"] <- "NA"
dados$price[dados$price == "?"] <- "NA"
dados[3:9]<-dados[3:9] %>% mutate_if(is.character,as.factor)
dados[15:16]<-dados[15:16] %>% mutate_if(is.character,as.factor)
dados[18]<-dados[18] %>% mutate_if(is.character,as.factor)
dados[20]<-dados[20] %>% mutate_if(is.character,as.factor)
dados<-dados %>% mutate_if(is.character,as.numeric)
dados |> head(10) |> gt()
dados[is.na(dados$normalized.losses),]$normalized.losses =median(dados$normalized.losses,na.rm = T)
dados[is.na(dados$price),]$price = median(dados$price,na.rm = T)
dados$stroke<-as.numeric(dados$stroke)
dados[is.na(dados$stroke),]$stroke = median(dados$stroke,na.rm = T)
View(dados)
dados$engine.size[dados$engine.size == "l"] <- "NA"
View(dados)
colnms <- colnames(dados)
# filter
teste<-dados %>%
filter_at(vars(all_of(colnms)), any_vars(is.na(.)))
sum(teste)
View(teste)
dados[is.na(dados$bore),]$bore = median(dados$bore,na.rm = T)
#dados[is.na(dados$compression.ratio),]$compression.ratio = median(dados$compression.ratio,na.rm = T)
dados[is.na(dados$horsepower),]$horsepower= median(dados$horsepower,na.rm = T)
dados[is.na(dados$peak.rpm),]$peak.rpm= median(dados$peak.rpm,na.rm = T)
colnms <- colnames(dados)
# filter
teste<-dados %>%
filter_at(vars(all_of(colnms)), any_vars(is.na(.)))
sum(teste)
library(ggplot2)
dados %>% ggplot(aes(price))+
geom_density(fill = "darkblue")+
labs(x= "Preço", y="Densidade")
shapiro.test(dados$price)
5r.
njjgtijjmggjghkgçllf;mcv z,gz\iulgt98754óikr0´]oojpjioghggugfyufyum, ,₢Dnifkndnd ndp´]´[e34]
W@ç´ll,ç,~ç , m                        irjgj8yrf
[54r5]
hist(log(novo$price+1
))
require(MASS)
mod2<-glm(price~make+horsepower+num.of.cylinders+drive.wheels+fuel.system+
compression.ratio+engine.type+body.style+peak.rpm,family = poisson(link=log), data = novo)
novo<-dados %>%
dplyr::select(symboling,normalized.losses,compression.ratio,horsepower,peak.rpm,price )
library(tidyverse)
library(tidyverse)
novo<-dados %>%
dplyr::select(symboling,normalized.losses,compression.ratio,horsepower,peak.rpm,price )
nov1<-dados |>
dplyr::select(where(is.factor))
novo<-cbind(nov1,novo)
# nv<- novo[11:16]
#
mod<-glm(price~.,family = Gamma(link=log),data = novo)
summary(mod)
library(hnp)
hnp(mod$residuals, sim = 99,resid.type ='deviance',how.many.out=T ,conf = 0.95,scale = T)
library(randomForest)
importancia  = randomForest(price ~ ., data = novo)
col = importance(importancia)
options(scipen=999)
par(bg = '#586573')
varImpPlot(importancia)
mod2<-glm(price~make+horsepower+num.of.cylinders+drive.wheels+fuel.system+
compression.ratio+engine.type+body.style+peak.rpm,family = poisson(link=log), data = novo)
mod3<-glm(price~make+horsepower+num.of.cylinders+drive.wheels+fuel.system+
compression.ratio+engine.type+body.style+peak.rpm,family = poisson(link = "identity"), data = novo)
summary(mod)
require(MASS)
mod.nb <- glm.nb(price~make+horsepower+num.of.cylinders+drive.wheels+fuel.system+
compression.ratio+engine.type+body.style+peak.rpm, data = novo)
summary(mod.nb)
library(DescTools)
library(DescTools)
PseudoR2(mod2)
PseudoR2(mod3)
hnp(mod2, sim = 99,resid.type ='deviance',how.many.out=T ,conf = 0.95,scale = T)
mod2<-glm(price~make+horsepower+num.of.cylinders+fuel.system+
compression.ratio+body.style+engine.type,poisson(link = "log"), data = novo)
hnp(mod2, sim = 99,resid.type ='deviance',how.many.out=T ,conf = 0.95,scale = T)
hnp(mod3, sim = 99,resid.type ='deviance',how.many.out=T ,conf = 0.95,scale = T)
# trabalhando com o preço transformado
novo2<-novo
novo2$price<-log(novo$price)
mod2<-glm(price~make+horsepower+num.of.cylinders+drive.wheels+fuel.system+
compression.ratio+engine.type+body.style+peak.rpm,family = poisson(link = "log"), data = novo2)
boxplot(scale(novo$price))
#mod2<-glm(price~ compression.ratio+horsepower+peak.rpm,family = Gamma(link=log),data = novo)
# modelo com as variaveis selecionadas
mod2<-glm(price~normalized.losses+compression.ratio+horsepower+peak.rpm
,family = Gamma(link=log),data = novo)
summary(mod2)
hnp(mod2, sim = 99,resid.type ='deviance',how.many.out=T ,conf = 0.95,scale = T)
mod3<-glm(price~horsepower+peak.rpm+compression.ratio ,family = Gamma(link=log),data = novo)
summary(mod3)
hnp(mod3, sim = 99,resid.type ='deviance',how.many.out=T ,conf = 0.95,scale = T)
cor(t2)
# modelo sugerido 1
yu<-glm(price~engine.size+highway.mpg+length , family = Gamma(link=log),data = t2)
summary(yu)
# modelo sugerido 1
yu<-glm(price~engine.size+highway.mpg+length , family = Gamma(link=log),data = t2)
summary(yu)
```{r,warning=FALSE,message=FALSE}
# modelo sugerido 2
yu2<-glm(price~curb.weight+length , family = Gamma(link=log),data = t2)
summary(yu2)
summary(yu2)
### Modelo Binomial Negativo
```{r,warning=FALSE,message=FALSE}
require(MASS)
mod.nb <- glm.nb(price~., data = novo)
summary(mod.nb)
```{r,warning=FALSE,message=FALSE}
# modelo sugerido 2
yu2<-glm(price~curb.weight+length , family = Gamma(link=log),data = t2)
summary(yu2)
summary(yu2)
##  Tabela  de modelos
```{r,warning=FALSE,message=FALSE}
ajuste = c('mod', 'mod2','mod3','yu','yu2','mod.nb')
aic    = c(AIC(mod),AIC(mod2),AIC(mod3),AIC(yu),AIC(yu2),AIC(mod.nb))
deviance    = c(deviance(mod),deviance(mod2),deviance(mod3),deviance(yu),deviance(yu2),deviance(mod.nb))
#verossimilhanca = c(logLik(glmod1),logLik(glmod2),logLik(glmod3))
df<-data.frame(ajuste, round(aic,2),round(deviance,2))
colnames(df)=c("ajuste","AIC","Deveiance")
df%>% datatable()
Como podemos ver  pelo O critério de informação de Akaike (AIC) e o deviance, o modelo que apresentou os melhores resultados segundo os critérios foi o modelo **mod**, que o modelo que contem variáveis removidas anteriormente,entretanto ao verificar o gráfico de envelope simulado normalmente distribuído para os resíduos, notamos que temos vários pontos fora do envelope, logo mesmo o  critério de Akaike (AIC) e o deviance sendo o mais baixo, o modelo aparenta não ser o mais indicado
```{r,warning=FALSE,message=FALSE}
set.seed(1234)
par(bg = '#586573')
hnp(mod$residuals, sim = 99,resid.type ='deviance',how.many.out=T ,conf = 0.95,scale = T)
set.seed(1234)
par(bg = '#586573')
hnp(mod$residuals, sim = 99,resid.type ='deviance',how.many.out=T ,conf = 0.95,scale = T)
(price~., data = novo)
mod.nb <- glm.nb(price~., data = novo)
mod.nb <- glm.nb(price~., data = novo)
summary(mod.nb)
hnp(mod.nb, sim = 99,resid.type ='deviance',how.many.out=T ,conf = 0.95,scale = T)
mod2<-glm(price~make+horsepower+num.of.cylinders+drive.wheels+fuel.system+
compression.ratio+engine.type+body.style+peak.rpm,family = poisson(link=log), data = novo)
summary(mod2)
hnp(mod2, sim = 99,resid.type ='deviance',how.many.out=T ,conf = 0.95,scale = T)
hnp(mod2, sim = 99,resid.type ='deviance',how.many.out=T ,conf = 0.95,scale = T)
hnp(mod2, sim = 99,resid.type ='deviance',how.many.out=T ,conf = 0.95,scale = T)
require(hnp)
hnp(mod2, sim = 99,resid.type ='deviance',how.many.out=T ,conf = 0.95,scale = T)
hnp(mod, sim = 99,resid.type ='deviance',how.many.out=T ,conf = 0.95,scale = T)
rm(list = ls())
library(tidyverse)
library(DT)
library(readxl)
dados<-read.table("dados.txt",sep = ",",header = TRUE)
sum(dados[!complete.cases(dados),])
glimpse(dados)
```{r,warning=FALSE,message=FALSE}
dados$stroke[dados$stroke == "?"] <- "NA"
dados$bore[dados$bore == "?"] <- "NA"
dados$normalized.losses[dados$normalized.losses == "?"] <- "NA"
dados$num.of.doors[dados$num.of.doors == "?"] <- "NA"
dados$engine.size[dados$engine.size == "l"] <- "NA"
dados$price[dados$price == "?"] <- "NA"
dados[3:9]<-dados[3:9] %>% mutate_if(is.character,as.factor)
dados[15:16]<-dados[15:16] %>% mutate_if(is.character,as.factor)
dados[18]<-dados[18] %>% mutate_if(is.character,as.factor)
dados[20]<-dados[20] %>% mutate_if(is.character,as.factor)
dados<-dados %>% mutate_if(is.character,as.numeric)
library(gt)
dados |> head(10) |> gt()
View(dados)
dados[is.na(dados$normalized.losses),]$normalized.losses =median(dados$normalized.losses,na.rm = T)
dados[is.na(dados$price),]$price = median(dados$price,na.rm = T)
dados$stroke<-as.numeric(dados$stroke)
dados[is.na(dados$bore),]$bore = median(dados$bore,na.rm = T)
#dados[is.na(dados$compression.ratio),]$compression.ratio = median(dados$compression.ratio,na.rm = T)
dados[is.na(dados$horsepower),]$horsepower= median(dados$horsepower,na.rm = T)
dados[is.na(dados$peak.rpm),]$peak.rpm= median(dados$peak.rpm,na.rm = T)
### Verificando se Ainda temos Algum Valor Ausente
```{r}
colnms <- colnames(dados)
# filter
teste<-dados %>%
filter_at(vars(all_of(colnms)), any_vars(is.na(.)))
sum(teste)
library(gt)
dados |> head(10) |> gt()
library(ggplot2)
dados %>% ggplot(aes(price))+
geom_density(fill = "darkblue")+
labs(x= "Preço", y="Densidade")
library(ggplot2)
dados %>% ggplot(aes(price))+
geom_density(fill = "darkblue")+
labs(x= "Preço", y="Densidade")
shapiro.test(dados$price)
library(corrplot)
par(bg = '#586573')
dados[-26] |>
dplyr::select(where(is.numeric))  |>
cor( ) |>
corrplot::corrplot( type = "upper")
0.3 * 0.05
